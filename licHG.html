<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tạo License Key (Mã Hóa)</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f0f2f5; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background-color: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); width: 400px; text-align: center; }
        h1 { color: #333; margin-bottom: 20px; }
        p { color: #666; margin-bottom: 25px; }
        input[type="date"] { width: 95%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 16px; margin-bottom: 20px; }
        button { width: 100%; padding: 12px; border: none; border-radius: 5px; background-color: #007bff; color: white; font-size: 16px; font-weight: bold; cursor: pointer; transition: background-color 0.2s; }
        button:hover { background-color: #0056b3; }
        #result-container { margin-top: 25px; text-align: left; }
        #result-key { background-color: #e9ecef; padding: 15px; border-radius: 5px; font-family: 'Courier New', Courier, monospace; font-weight: bold; color: #495057; word-wrap: break-word; }
    </style>
</head>
<body>

    <div class="container">
        <h1>Tạo License Key (Mã Hóa)</h1>
        <p>Chọn ngày hết hạn để tạo file <strong>.lic</strong> đã được mã hóa.</p>
        
        <input type="date" id="expiry-date-input">
        
        <button id="generate-btn">Tạo File .lic</button>

        <div id="result-container" style="display: none;">
            <p><strong>Key mã hóa (nội dung file .lic):</strong></p>
            <pre id="result-key"></pre>
        </div>
    </div>

    <script>
        // --- PHẦN 1: TỰ ĐỘNG ĐẶT NGÀY HẾT HẠN ---
        window.onload = function() {
            const dateInput = document.getElementById('expiry-date-input');
            const currentDate = new Date();
            currentDate.setMonth(currentDate.getMonth() + 3);

            const year = currentDate.getFullYear();
            const month = String(currentDate.getMonth() + 1).padStart(2, '0');
            const day = String(currentDate.getDate()).padStart(2, '0');
            
            const futureDate = `${year}-${month}-${day}`;
            dateInput.value = futureDate;
        };

        // --- PHẦN 2: THÊM CHỨC NĂNG TẠO VÀ TẢI FILE KHI NHẤN NÚT ---
        document.getElementById('generate-btn').addEventListener('click', function() {
            const expiryDate = document.getElementById('expiry-date-input').value;
            
            if (!expiryDate) {
                alert('Vui lòng chọn ngày hết hạn!');
                return;
            }

            // Tạo nội dung cho file. Ở đây ta mã hóa Base64 cho đơn giản.
            // Trong thực tế bạn sẽ dùng một thuật toán mã hóa phức tạp hơn.
            const fileContent = `ExpiryDate: ${expiryDate}`;
            const encryptedContent = btoa(fileContent); // btoa() là hàm mã hóa Base64 có sẵn

            // Hiển thị key đã mã hóa lên trang (tùy chọn)
            const resultContainer = document.getElementById('result-container');
            const resultKey = document.getElementById('result-key');
            resultKey.textContent = encryptedContent;
            resultContainer.style.display = 'block';

            // Hàm để tạo và tải file
            function downloadFile(filename, content) {
                const element = document.createElement('a');
                const blob = new Blob([content], { type: 'text/plain' });
                const fileUrl = URL.createObjectURL(blob);
                
                element.setAttribute('href', fileUrl);
                element.setAttribute('download', filename);
                element.style.display = 'none';
                
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);
            }

            // Gọi hàm tải file
            downloadFile('license.lic', encryptedContent);
        });
    </script>

</body>
</html>
